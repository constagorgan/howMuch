<div class="dots_bg"></div>
<div class='body_content'>
  <div id="search_container_main_view" class="search_container">
    <i class="glyphicon glyphicon-search only_large_display search_input_legend"></i>
    <input id="search-input" class="search_input" type="text" placeholder="Look up an event ..." class="form-control input-md" />
    <div class="search_list_controller_group">
      <span class="search_btn_container">
      <button class="btn btn_search" type="button">
        <span>
          <i class="glyphicon glyphicon-search only_mobile_display"></i>
          <span class="search_btn_text_search only_large_display">Search</span>
        </span>
      </button>
      </span>
    </div>   
  </div>

  <div class="homepage_img_container">
    <div class="dots_bg"></div>
  </div>

  <div id="events_div" class="homepage_events_container">

    <% var categoriesCounter = 0;
       var categoryKeys = Object.keys(response);   
       
       Array.prototype.move = function(from,to){
          this.splice(to,0,this.splice(from,1)[0]);
          return this;
       };
       
       categoryKeys.move(9, 1);
       categoryKeys.move(11, 2);
       categoryKeys.move(11, 6);
       
       categoryKeys.forEach(function(key,index) {
         var currentEventCategory = response[key];
         categoriesCounter += 1; %>

      <div class="col-xs-12 col-sm-12 col-md-4 no_bootstrap_padding homepage_event_category_container">

        <h3 class="homepage_event_category_h3">
          <%=key === 'upcoming' ? 'local ' + key : key%>
          <span class="homepage_event_category_h3_span">events</span>
        </h3>
        <ul class="homepage_event_category_ul">
          <% if (currentEventCategory.length <= 0) { %>
            <li class="homepage_event_category_li_unavailable">
              <div class="homepage_event_category_li_text_unavailable ellipsis">
                No events here.
              </div>
            </li>
          <% } %>
          <% for(var i = 0; i < currentEventCategory.length; i++) { %>
            <li class="homepage_event_li homepage_event_category_li" id="<%=currentEventCategory[i].id + '_' + currentEventCategory[i].name%>">
              <a href="/#event/<%=encodeURIComponent(currentEventCategory[i].name) + '/' + currentEventCategory[i].id %>">
                <div class="li_background_pic" style="background: url(../Content/img/background/<%=currentEventCategory[i].background%>_medium.jpg);"></div>
                <div class="black_overlay position_absolute"></div>

                <div class="homepage_event_category_li_date">
                  <%= (currentEventCategory[i].isLocal && parseInt(currentEventCategory[i].isLocal)) ?
                     moment(new Date(moment.utc(currentEventCategory[i].eventDate))).format("D") : 
                     moment(currentEventCategory[i].eventDate).format("D")%>
                  <div class="homepage_event_category_li_date_month">
                    <%= (currentEventCategory[i].isLocal && parseInt(currentEventCategory[i].isLocal)) ?
                       moment(new Date(moment.utc(currentEventCategory[i].eventDate))).format("MMM") : 
                       moment(currentEventCategory[i].eventDate).format("MMM") %>
                  </div>
                  <div class="homepage_event_category_li_date_year">
                    <%= (currentEventCategory[i].isLocal && parseInt(currentEventCategory[i].isLocal)) ?
                       moment(new Date(moment.utc(currentEventCategory[i].eventDate))).format("YYYY"):
                       moment(currentEventCategory[i].eventDate).format("YYYY") %>
                  </div>
                </div>

                <div class="homepage_event_category_li_text ellipsis">
                  <%=currentEventCategory[i].name%>
                  <div class="homepage_event_category_li_text_location category_event_li_text"><% if(currentEventCategory[i].location) { %><%=currentEventCategory[i].location%><% } else { %>WorldWide<% } %>&nbsp;
                  </div>
                  <div class="homepage_event_category_li_text_creator">
                    Created by: <span class="homepage_event_category_li_text_creator_span"><%=currentEventCategory[i].creatorUser%></span>
                  </div>
                </div>
              </a>
            </li>
          <% } %>
                
          <li class="homepage_category_li homepage_event_category_li light_blue_bg text_align_center" id="<%=key%>">
            <a class="homepage_event_category_li_see_more" href="/#category/<%=encodeURIComponent(key) + (key === 'local' ? '&country_code=' + countryCode : '')%>">
              <%=key === 'upcoming' ? 'see more' : 'see more from'%>
              <span class="homepage_event_category_li_see_more_span">
                <%= (key === 'upcoming' ? ' global ' + key + ' events': ' ' + key)%>
              </span>
            </a>
          </li>
        </ul>

      </div>
      <% if ((categoriesCounter % 3) === 0) { %>
        <div class="clear"></div>
      <% } %>
    <% }); %>

    <span id="top-link-block" class="hidden only_mobile_display">
      <a href="#top" class="well well-sm"  onclick="$('html,body').animate({scrollTop:0},'slow');return false;">
        <i class="glyphicon glyphicon-chevron-up" id="glyphicon-go-top"></i>
      </a>
    </span>

  </div>

</div>
